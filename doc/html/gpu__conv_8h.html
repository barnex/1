<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GPU_simulations: gpu_conv.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>gpu_conv.h File Reference</h1><code>#include &quot;<a class="el" href="gputil_8h_source.html">gputil.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tensor_8h_source.html">tensor.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="param_8h_source.html">param.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="kernel_8h_source.html">kernel.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gpufft2_8h_source.html">gpufft2.h</a>&quot;</code><br/>
<code>#include &quot;assert.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>

<p><a href="gpu__conv_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structconv__data.html">conv_data</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#a0848e6c978fdabd3e58c7d8781b6d174">evaluate_convolution</a> (<a class="el" href="structtensor.html">tensor</a> *m, <a class="el" href="structtensor.html">tensor</a> *h, <a class="el" href="structconv__data.html">conv_data</a> *conv, <a class="el" href="structparam.html">param</a> *p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#a2c4567e3d08af267f1d67e1afc91d64e">evaluate_micromag3d_conv</a> (<a class="el" href="structtensor.html">tensor</a> *m, <a class="el" href="structtensor.html">tensor</a> *h, <a class="el" href="structconv__data.html">conv_data</a> *conv)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#a8a5da1ee93143360a4f660e31fed8fb0">gpu_kernel_mul_micromag3d</a> (<a class="el" href="structtensor.html">tensor</a> *fft1, <a class="el" href="structtensor.html">tensor</a> *kernel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__global__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#aae98f437aec9e6c1b4f49f35a34ab1c9">_gpu_kernel_mul_micromag3d</a> (float *fftMx, float *fftMy, float *fftMz, float *fftKxx, float *fftKxy, float *fftKxz, float *fftKyy, float *fftKyz, float *fftKzz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#a9e2af2f0825e40da45fb3f47dcc5ee59">evaluate_micromag3d_conv_Xthickness_1</a> (<a class="el" href="structtensor.html">tensor</a> *m, <a class="el" href="structtensor.html">tensor</a> *h, <a class="el" href="structconv__data.html">conv_data</a> *conv)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#abfba4d8cd8807eec6626827d8158e5b8">gpu_kernel_mul_micromag3d_Xthickness_1</a> (<a class="el" href="structtensor.html">tensor</a> *fft1, <a class="el" href="structtensor.html">tensor</a> *kernel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__global__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#abac37b82c536c514592f6960ba711512">_gpu_kernel_mul_micromag3d_Xthickness_1</a> (float *fftMx, float *fftMy, float *fftMz, float *fftKxx, float *fftKyy, float *fftKyz, float *fftKzz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#ab9000a16284ca5231c2d6c6d953b6c18">evaluate_micromag2d_conv</a> (<a class="el" href="structtensor.html">tensor</a> *m, <a class="el" href="structtensor.html">tensor</a> *h, <a class="el" href="structconv__data.html">conv_data</a> *conv)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#aa424b1c7fdfb2c5569a1a97235303550">gpu_kernel_mul_micromag2d</a> (<a class="el" href="structtensor.html">tensor</a> *fft1, <a class="el" href="structtensor.html">tensor</a> *kernel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__global__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#a6ac9c6e1f8ee05181c1dd75b97c9efe9">_gpu_kernel_mul_micromag2d</a> (float *fftMy, float *fftMz, float *fftKyy, float *fftKyz, float *fftKzz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structconv__data.html">conv_data</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#a4e0c6140920c05095b2ca2a5037f55e7">new_conv_data</a> (<a class="el" href="structparam.html">param</a> *p, <a class="el" href="structtensor.html">tensor</a> *kernel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__global__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#a20af60fe31db3ff8fd148a5489283f0e">_gpu_copy_pad</a> (float *source, float *dest, int S1, int S2, int D1, int D2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#ae49d40e1a1521a0a50be182c883cb81b">gpu_copy_to_pad</a> (float *source, float *dest, int *unpad_size4d, int *pad_size4d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpu__conv_8h.html#a3e70d2785bf9f60ad41661cea6bba1e2">gpu_copy_to_unpad</a> (float *source, float *dest, int *pad_size4d, int *unpad_size4d)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This file contains all functions related with the initialization and execution of the convolutions.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Ben Van de Wiele, Arne Vansteenkiste </dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a20af60fe31db3ff8fd148a5489283f0e"></a><!-- doxytag: member="gpu_conv.h::_gpu_copy_pad" ref="a20af60fe31db3ff8fd148a5489283f0e" args="(float *source, float *dest, int S1, int S2, int D1, int D2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void _gpu_copy_pad </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>S1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>S2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>D1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>D2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>Does padding and unpadding, not necessarily by a factor 2 </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>source data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>destination data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S1</em>&nbsp;</td><td>source size Y </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S2</em>&nbsp;</td><td>source size Z </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>D1</em>&nbsp;</td><td>destination size Y </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>D2</em>&nbsp;</td><td>destination size Z </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6ac9c6e1f8ee05181c1dd75b97c9efe9"></a><!-- doxytag: member="gpu_conv.h::_gpu_kernel_mul_micromag2d" ref="a6ac9c6e1f8ee05181c1dd75b97c9efe9" args="(float *fftMy, float *fftMz, float *fftKyy, float *fftKyz, float *fftKzz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void _gpu_kernel_mul_micromag2d </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftMy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftMz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKyy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKzz</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fftMy</em>&nbsp;</td><td>Fourier transformed My data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftMz</em>&nbsp;</td><td>Fourier transformed Mz data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKyy</em>&nbsp;</td><td>yy kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKyz</em>&nbsp;</td><td>yz kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKzz</em>&nbsp;</td><td>zz kernel component </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aae98f437aec9e6c1b4f49f35a34ab1c9"></a><!-- doxytag: member="gpu_conv.h::_gpu_kernel_mul_micromag3d" ref="aae98f437aec9e6c1b4f49f35a34ab1c9" args="(float *fftMx, float *fftMy, float *fftMz, float *fftKxx, float *fftKxy, float *fftKxz, float *fftKyy, float *fftKyz, float *fftKzz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void _gpu_kernel_mul_micromag3d </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftMx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftMy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftMz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKxz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKyy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKzz</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Actual multiplication on gpu of the MICROMAG3D kernel with a sample thickness of more then one (possibly coarse level) FD cell. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fftMx</em>&nbsp;</td><td>Fourier transformed Mx data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftMy</em>&nbsp;</td><td>Fourier transformed My data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftMz</em>&nbsp;</td><td>Fourier transformed Mz data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKxx</em>&nbsp;</td><td>xx kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKxy</em>&nbsp;</td><td>xy kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKxz</em>&nbsp;</td><td>xz kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKyy</em>&nbsp;</td><td>yy kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKyz</em>&nbsp;</td><td>yz kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKzz</em>&nbsp;</td><td>zz kernel component </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abac37b82c536c514592f6960ba711512"></a><!-- doxytag: member="gpu_conv.h::_gpu_kernel_mul_micromag3d_Xthickness_1" ref="abac37b82c536c514592f6960ba711512" args="(float *fftMx, float *fftMy, float *fftMz, float *fftKxx, float *fftKyy, float *fftKyz, float *fftKzz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void _gpu_kernel_mul_micromag3d_Xthickness_1 </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftMx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftMy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftMz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKyy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>fftKzz</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Actual multiplication on gpu of the MICROMAG3D kernel with a sample thickness of one (possibly coarse level) FD cell. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fftMx</em>&nbsp;</td><td>Fourier transformed Mx data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftMy</em>&nbsp;</td><td>Fourier transformed My data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftMz</em>&nbsp;</td><td>Fourier transformed Mz data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKxx</em>&nbsp;</td><td>xx kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKyy</em>&nbsp;</td><td>yy kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKyz</em>&nbsp;</td><td>yz kernel component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fftKzz</em>&nbsp;</td><td>zz kernel component </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0848e6c978fdabd3e58c7d8781b6d174"></a><!-- doxytag: member="gpu_conv.h::evaluate_convolution" ref="a0848e6c978fdabd3e58c7d8781b6d174" args="(tensor *m, tensor *h, conv_data *conv, param *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evaluate_convolution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structconv__data.html">conv_data</a> *&nbsp;</td>
          <td class="paramname"> <em>conv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparam.html">param</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Evaluates a convolution. The input is the magnetization tensor m, the output is the magnetic field tensor h. All required work space, the kernel and the corresponding FFT plan are referred ate in the convolution data 'conv'. Before using this function, the convolution data should be initialized using the function: <a class="el" href="gpu__conv_8h.html#a4e0c6140920c05095b2ca2a5037f55e7">new_conv_data(param *p, tensor *kernel)</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>input: rank 4 tensor containing the magnetization data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>output: rank 4 tensor containing the field data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conv</em>&nbsp;</td><td>convolution data: work space, kernel. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>parameter list </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab9000a16284ca5231c2d6c6d953b6c18"></a><!-- doxytag: member="gpu_conv.h::evaluate_micromag2d_conv" ref="ab9000a16284ca5231c2d6c6d953b6c18" args="(tensor *m, tensor *h, conv_data *conv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evaluate_micromag2d_conv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structconv__data.html">conv_data</a> *&nbsp;</td>
          <td class="paramname"> <em>conv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Evaluates a convolution of type MICROMAG2D. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>input: rank 4 tensor containing the magnetization data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>output: rank 4 tensor containing the field data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conv</em>&nbsp;</td><td>convolution data: work space, kernel, FFT plan. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2c4567e3d08af267f1d67e1afc91d64e"></a><!-- doxytag: member="gpu_conv.h::evaluate_micromag3d_conv" ref="a2c4567e3d08af267f1d67e1afc91d64e" args="(tensor *m, tensor *h, conv_data *conv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evaluate_micromag3d_conv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structconv__data.html">conv_data</a> *&nbsp;</td>
          <td class="paramname"> <em>conv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Evaluates a convolution of type MICROMAG3D with a sample thickness of more then one (possibly coarse level) FD cell. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>input: rank 4 tensor containing the magnetization data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>output: rank 4 tensor containing the field data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conv</em>&nbsp;</td><td>convolution data: work space, kernel, FFT plan. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9e2af2f0825e40da45fb3f47dcc5ee59"></a><!-- doxytag: member="gpu_conv.h::evaluate_micromag3d_conv_Xthickness_1" ref="a9e2af2f0825e40da45fb3f47dcc5ee59" args="(tensor *m, tensor *h, conv_data *conv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evaluate_micromag3d_conv_Xthickness_1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structconv__data.html">conv_data</a> *&nbsp;</td>
          <td class="paramname"> <em>conv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Evaluates a convolution of type MICROMAG3D with a sample thickness of one (possibly coarse level) FD cell. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>input: rank 4 tensor containing the magnetization data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>output: rank 4 tensor containing the field data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conv</em>&nbsp;</td><td>convolution data: work space, kernel, FFT plan. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae49d40e1a1521a0a50be182c883cb81b"></a><!-- doxytag: member="gpu_conv.h::gpu_copy_to_pad" ref="ae49d40e1a1521a0a50be182c883cb81b" args="(float *source, float *dest, int *unpad_size4d, int *pad_size4d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpu_copy_to_pad </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>unpad_size4d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>pad_size4d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>pads the input tensor 'source' and saves it in tensor 'dest', 2d and 3d applicable. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>input: unpadded source as contiguous float array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>output: padded destination as contiguous float array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>unpad_size4d</em>&nbsp;</td><td>size of the corresponding unpadded tensor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pad_size4d</em>&nbsp;</td><td>size of the corresponding padded tensor </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3e70d2785bf9f60ad41661cea6bba1e2"></a><!-- doxytag: member="gpu_conv.h::gpu_copy_to_unpad" ref="a3e70d2785bf9f60ad41661cea6bba1e2" args="(float *source, float *dest, int *pad_size4d, int *unpad_size4d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpu_copy_to_unpad </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>pad_size4d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>unpad_size4d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>copies the non-zero elements from the padded the input tensor 'source' towards tensor 'dest', 2d and 3d applicable. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>input: padded source as contiguous float array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>output: unpadded destination as contiguous float array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pad_size4d</em>&nbsp;</td><td>size of the corresponding padded tensor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>unpad_size4d</em>&nbsp;</td><td>size of the corresponding unpadded tensor </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa424b1c7fdfb2c5569a1a97235303550"></a><!-- doxytag: member="gpu_conv.h::gpu_kernel_mul_micromag2d" ref="aa424b1c7fdfb2c5569a1a97235303550" args="(tensor *fft1, tensor *kernel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpu_kernel_mul_micromag2d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>fft1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>kernel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fft1</em>&nbsp;</td><td>Fourier transformed data (as input: m-data, when exiting: h-data) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kernel</em>&nbsp;</td><td>MICROMAG3d kernel </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8a5da1ee93143360a4f660e31fed8fb0"></a><!-- doxytag: member="gpu_conv.h::gpu_kernel_mul_micromag3d" ref="a8a5da1ee93143360a4f660e31fed8fb0" args="(tensor *fft1, tensor *kernel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpu_kernel_mul_micromag3d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>fft1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>kernel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Evaluates the kernel multiplication for the MICROMAG3D kernel with a sample thickness of more then one (possibly coarse level) FD cell. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fft1</em>&nbsp;</td><td>Fourier transformed data (as input: m-data, when exiting: h-data) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kernel</em>&nbsp;</td><td>MICROMAG3d kernel </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abfba4d8cd8807eec6626827d8158e5b8"></a><!-- doxytag: member="gpu_conv.h::gpu_kernel_mul_micromag3d_Xthickness_1" ref="abfba4d8cd8807eec6626827d8158e5b8" args="(tensor *fft1, tensor *kernel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpu_kernel_mul_micromag3d_Xthickness_1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>fft1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>kernel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Evaluates the kernel multiplication for the MICROMAG3D kernel with a sample thickness of one (possibly coarse level) FD cell. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fft1</em>&nbsp;</td><td>Fourier transformed data (as input: m-data, when exiting: h-data) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kernel</em>&nbsp;</td><td>MICROMAG3d kernel </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4e0c6140920c05095b2ca2a5037f55e7"></a><!-- doxytag: member="gpu_conv.h::new_conv_data" ref="a4e0c6140920c05095b2ca2a5037f55e7" args="(param *p, tensor *kernel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structconv__data.html">conv_data</a>* new_conv_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structparam.html">param</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>kernel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initializes the convolution data based on the parameter list p and links to the initialized kernel. Before using this function, the kernel data should be initialized using the function: <a class="el" href="kernel_8h.html#ae7a1d6779f775bea9d4f6dc64571a25a">new_kernel(param *p)</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>parameter list </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kernel</em>&nbsp;</td><td>tensor containing the kernel data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jul 6 16:19:19 2010 for GPU_simulations by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
