<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GPU_simulations: gpukernel1.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>gpukernel1.h File Reference</h1><code>#include &quot;<a class="el" href="tensor_8h_source.html">tensor.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gputil_8h_source.html">gputil.h</a>&quot;</code><br/>
<code>#include &lt;cufft.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="gpufft_8h_source.html">gpufft.h</a>&quot;</code><br/>
<code>#include &quot;assert.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>

<p><a href="gpukernel1_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpukernel1_8h.html#adb1e5d71a43a60425562d14f48c72be0">gpu_init_Greens_kernel1</a> (<a class="el" href="structtensor.html">tensor</a> *dev_kernel, int <a class="el" href="gpufft2__test_8cpp.html#a1a345a1e634b1d40f23b3333f3696366">N0</a>, int <a class="el" href="gpufft2__test_8cpp.html#a5a6a26e0827f9640d2eb7201017f19d7">N1</a>, int <a class="el" href="gpufft2__test_8cpp.html#adeea8075a0038c985c63d45161804d60">N2</a>, int *zero_pad, int *repetition, float *FD_cell_size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpukernel1_8h.html#a83a756b402262d0484dfeb9ea6b95d9c">gpu_init_and_FFT_Greens_kernel_elements_1</a> (<a class="el" href="structtensor.html">tensor</a> *dev_kernel, int *Nkernel, float *FD_cell_size, float cst, int *repetition, float *dev_qd_P_10, float *dev_qd_W_10, <a class="el" href="structgpu__plan3d__real__input.html">gpu_plan3d_real_input</a> *kernel_plan)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__global__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpukernel1_8h.html#aa5af2ceb01d29c3fa24c4c8cdf32481b">_gpu_init_Greens_kernel_elements_1</a> (float *dev_temp, int Nkernel_X, int Nkernel_Y, int Nkernel_Z, int co1, int co2, float FD_cell_size_X, float FD_cell_size_Y, float FD_cell_size_Z, float cst, int repetition_X, int repetition_Y, int repetition_Z, float *qd_P_10, float *qd_W_10)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__device__ float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpukernel1_8h.html#a033675f8b51bddec740566c0a6a75ae0">_gpu_get_Greens_element_1</a> (int Nkernel_X, int Nkernel_Y, int Nkernel_Z, int co1, int co2, int a, int b, int c, float FD_cell_size_X, float FD_cell_size_Y, float FD_cell_size_Z, float cst, int repetition_X, int repetition_Y, int repetition_Z, float *dev_qd_P_10, float *dev_qd_W_10)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__global__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpukernel1_8h.html#a3c1528915e3568add606651c3d1be933">_gpu_extract_real_parts_1</a> (float *dev_kernel_array, float *dev_temp, int rank0, int size1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpukernel1_8h.html#a920336fcc0f17ca570d38f18dc3534fb">initialize_Gauss_quadrature_on_gpu_1</a> (float *dev_qd_W_10, float *dev_qd_P_10, float *FD_cell_size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpukernel1_8h.html#a58460242486084023cdf529f7814acb5">get_Quad_Points_1</a> (float *gaussQP, float *stdgaussQ, int qOrder, double a, double b)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Initialization of the Greens function kernel adapted to the FFT dimensions of gpufft.cu. The Kernel components are Fourier transformed and only the real parts are stored on the device.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Ben Van de Wiele </dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a3c1528915e3568add606651c3d1be933"></a><!-- doxytag: member="gpukernel1.h::_gpu_extract_real_parts_1" ref="a3c1528915e3568add606651c3d1be933" args="(float *dev_kernel_array, float *dev_temp, int rank0, int size1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void _gpu_extract_real_parts_1 </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_kernel_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rank0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Extracts the 'size1' real numbers from the array 'dev_temp' and stores them in the 'dev_kernel_array' starting from 'dev_kernel_array[rank0*size1]'. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev_kernel_array</em>&nbsp;</td><td>rank 2 tensor; rank 0: xx, xy, xz, yy, yz, zz parts of symmetrical Greens tensor, rank 1: all data of a Greens kernel component contiguously </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dev_temp</em>&nbsp;</td><td>pointer to the temporary memory space on the device to store all elements of a given Greens tensor component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rank0</em>&nbsp;</td><td>int defining the rank 0 number: xx=0, xy=1, xz=2, etc. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size1</em>&nbsp;</td><td>length of a Fourier transformed Greens kernel component (only real parts). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a033675f8b51bddec740566c0a6a75ae0"></a><!-- doxytag: member="gpukernel1.h::_gpu_get_Greens_element_1" ref="a033675f8b51bddec740566c0a6a75ae0" args="(int Nkernel_X, int Nkernel_Y, int Nkernel_Z, int co1, int co2, int a, int b, int c, float FD_cell_size_X, float FD_cell_size_Y, float FD_cell_size_Z, float cst, int repetition_X, int repetition_Y, int repetition_Z, float *dev_qd_P_10, float *dev_qd_W_10)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ float _gpu_get_Greens_element_1 </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Nkernel_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Nkernel_Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Nkernel_Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>co1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>co2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size_Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size_Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>cst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>repetition_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>repetition_Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>repetition_Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_qd_P_10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_qd_W_10</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns an element with coordinates [a,b,c] of the Greens kernel component defined by 'co1, co2'. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Nkernel_X</em>&nbsp;</td><td>Non-strided size of the kernel data (x-direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Nkernel_Y</em>&nbsp;</td><td>Non-strided size of the kernel data (y-direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Nkernel_Z</em>&nbsp;</td><td>Non-strided size of the kernel data (z-direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>co1</em>&nbsp;</td><td>co1 and co2 define the requested Greens tensor component: e.g. co1=0, co2=1 defines gxy </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>co2</em>&nbsp;</td><td>co1 and co2 define the requested Greens tensor component: e.g. co1=0, co2=1 defines gxy </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>[a,b,c] defines the cartesian vector pointing to the source FD cell to the receiver FD cell (in units FD cell size) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>[a,b,c] defines the cartesian vector pointing to the source FD cell to the receiver FD cell (in units FD cell size) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>[a,b,c] defines the cartesian vector pointing to the source FD cell to the receiver FD cell (in units FD cell size) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size_X</em>&nbsp;</td><td>Size of the used FD cells in the x direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size_Y</em>&nbsp;</td><td>Size of the used FD cells in the y direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size_Z</em>&nbsp;</td><td>Size of the used FD cells in the z direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cst</em>&nbsp;</td><td>constant preceeding all Greens tensor elements (includes the correction for the dimensions of the FFTs in the convolution!) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>repetition_X</em>&nbsp;</td><td>2*repetition_X+1 is the number of periods considered the x-direction (repetition_X=0 means no repetion in x direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>repetition_Y</em>&nbsp;</td><td>2*repetition_Y+1 is the number of periods considered the y-direction (repetition_Y=0 means no repetion in y direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>repetition_Z</em>&nbsp;</td><td>2*repetition_Z+1 is the number of periods considered the z-direction (repetition_Z=0 means no repetion in z direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dev_qd_P_10</em>&nbsp;</td><td>float array (30 floats) containing the 10 Gauss quadrature points for X, Y and Z contiguously (on device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dev_qd_W_10</em>&nbsp;</td><td>float array (10 floats) containing the 10 Gauss quadrature weights (on device) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa5af2ceb01d29c3fa24c4c8cdf32481b"></a><!-- doxytag: member="gpukernel1.h::_gpu_init_Greens_kernel_elements_1" ref="aa5af2ceb01d29c3fa24c4c8cdf32481b" args="(float *dev_temp, int Nkernel_X, int Nkernel_Y, int Nkernel_Z, int co1, int co2, float FD_cell_size_X, float FD_cell_size_Y, float FD_cell_size_Z, float cst, int repetition_X, int repetition_Y, int repetition_Z, float *qd_P_10, float *qd_W_10)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void _gpu_init_Greens_kernel_elements_1 </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Nkernel_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Nkernel_Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Nkernel_Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>co1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>co2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size_Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size_Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>cst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>repetition_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>repetition_Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>repetition_Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>qd_P_10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>qd_W_10</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Computes all elements of the Greens kernel component defined by 'co1, co2'. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev_temp</em>&nbsp;</td><td>pointer to the temporary memory space on the device to store all elements of a given Greens tensor component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Nkernel_X</em>&nbsp;</td><td>Non-strided size of the kernel data (x-direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Nkernel_Y</em>&nbsp;</td><td>Non-strided size of the kernel data (y-direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Nkernel_Z</em>&nbsp;</td><td>Non-strided size of the kernel data (z-direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>co1</em>&nbsp;</td><td>co1 and co2 define the requested Greens tensor component: e.g. co1=0, co2=1 defines gxy </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>co2</em>&nbsp;</td><td>co1 and co2 define the requested Greens tensor component: e.g. co1=0, co2=1 defines gxy </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size_X</em>&nbsp;</td><td>Size of the used FD cells in the x direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size_Y</em>&nbsp;</td><td>Size of the used FD cells in the y direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size_Z</em>&nbsp;</td><td>Size of the used FD cells in the z direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cst</em>&nbsp;</td><td>constant preceeding all Greens tensor elements (includes the correction for the dimensions of the FFTs in the convolution!) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>repetition_X</em>&nbsp;</td><td>2*repetition_X+1 is the number of periods considered the x-direction (repetition_X=0 means no repetion in x direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>repetition_Y</em>&nbsp;</td><td>2*repetition_Y+1 is the number of periods considered the y-direction (repetition_Y=0 means no repetion in y direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>repetition_Z</em>&nbsp;</td><td>2*repetition_Z+1 is the number of periods considered the z-direction (repetition_Z=0 means no repetion in z direction) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qd_P_10</em>&nbsp;</td><td>float array (30 floats) containing the 10 Gauss quadrature points for X, Y and Z contiguously (on device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qd_W_10</em>&nbsp;</td><td>float array (10 floats) containing the 10 Gauss quadrature weights (on device) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a58460242486084023cdf529f7814acb5"></a><!-- doxytag: member="gpukernel1.h::get_Quad_Points_1" ref="a58460242486084023cdf529f7814acb5" args="(float *gaussQP, float *stdgaussQ, int qOrder, double a, double b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_Quad_Points_1 </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>gaussQP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>stdgaussQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qOrder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the quadrature points for integration between a and b </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>gaussQP</em>&nbsp;</td><td>float array containing the requested Gauss quadrature points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stdgaussQ</em>&nbsp;</td><td>standard Gauss quadrature points between -1 and +1 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qOrder</em>&nbsp;</td><td>Gauss quadrature order </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>integration lower bound </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>integration upper bound </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a83a756b402262d0484dfeb9ea6b95d9c"></a><!-- doxytag: member="gpukernel1.h::gpu_init_and_FFT_Greens_kernel_elements_1" ref="a83a756b402262d0484dfeb9ea6b95d9c" args="(tensor *dev_kernel, int *Nkernel, float *FD_cell_size, float cst, int *repetition, float *dev_qd_P_10, float *dev_qd_W_10, gpu_plan3d_real_input *kernel_plan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpu_init_and_FFT_Greens_kernel_elements_1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>dev_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>Nkernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>cst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>repetition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_qd_P_10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_qd_W_10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgpu__plan3d__real__input.html">gpu_plan3d_real_input</a> *&nbsp;</td>
          <td class="paramname"> <em>kernel_plan</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initializes the Greens kernel elements, Fourier transforms the data and extracts the real parts from the data. (imaginary parts are zero in due to the symmetry) The kernel is only stored at the device. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev_kernel</em>&nbsp;</td><td>rank 2 tensor; rank 0: xx, xy, xz, yy, yz, zz parts of symmetrical Greens tensor, rank 1: all data of a Greens kernel component contiguously </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Nkernel</em>&nbsp;</td><td>Non-strided size of the kernel data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size</em>&nbsp;</td><td>3 float, size of finite difference cell in X,Y,Z respectively </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cst</em>&nbsp;</td><td>constant factor preceeding the expression of the magnetostatic field </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>repetition</em>&nbsp;</td><td>3 ints, for periodicity: e.g. 2*repetition[0]+1 is the number of periods considered the x-direction ([0,0,0] means no periodic repetition) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dev_qd_P_10</em>&nbsp;</td><td>float array (30 floats) containing the 10 Gauss quadrature points for X, Y and Z contiguously (on device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dev_qd_W_10</em>&nbsp;</td><td>float array (10 floats) containing the 10 Gauss quadrature weights (on device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kernel_plan</em>&nbsp;</td><td>FFT plan for the execution of the forward FFT of the kernel. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adb1e5d71a43a60425562d14f48c72be0"></a><!-- doxytag: member="gpukernel1.h::gpu_init_Greens_kernel1" ref="adb1e5d71a43a60425562d14f48c72be0" args="(tensor *dev_kernel, int N0, int N1, int N2, int *zero_pad, int *repetition, float *FD_cell_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpu_init_Greens_kernel1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtensor.html">tensor</a> *&nbsp;</td>
          <td class="paramname"> <em>dev_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>N0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>N1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>N2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>zero_pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>repetition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initializes the Greens function kernel. The kernel is stored as a rank 2 tensor: The i+j element (j&gt;=i) of kernel[i+j][k] contains the contigous Fourier transformed data connecting the (Fourier transformed) i-component of the magnetic field with the (Fourier transformed) j-component of the magnetization. The size is addapted to the gpu-memory.</p>
<p>This function includes:</p>
<ul>
<li>computation of the elements of the Greens kernel components</li>
<li>Fourier transformation of the Greens kernel components</li>
<li>in Fourier domain: extraction of the real parts (complex parts are zero due to symmetry)</li>
</ul>
<p>note that the correction factor 1/(dimensions FFTs) is already included. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev_kernel</em>&nbsp;</td><td>rank 2 tensor (rank 1: xx, xy, xz, yy, yz, zz parts of symmetrical Greens tensor) containing all contiguous Greens function data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>N0</em>&nbsp;</td><td>size of simulation in x-direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>N1</em>&nbsp;</td><td>size of simulation in y-direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>N2</em>&nbsp;</td><td>size of simulation in z-direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zero_pad</em>&nbsp;</td><td>3 ints, should be 1 or 0, meaning zero-padding or no zero-padding in X,Y,Z respectively </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>repetition</em>&nbsp;</td><td>3 ints, for periodicity: e.g. 2*repetition[0]+1 is the number of periods considered the x-direction </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size</em>&nbsp;</td><td>3 float, size of finite difference cell in X,Y,Z respectively </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a920336fcc0f17ca570d38f18dc3534fb"></a><!-- doxytag: member="gpukernel1.h::initialize_Gauss_quadrature_on_gpu_1" ref="a920336fcc0f17ca570d38f18dc3534fb" args="(float *dev_qd_W_10, float *dev_qd_P_10, float *FD_cell_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize_Gauss_quadrature_on_gpu_1 </td>
          <td>(</td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_qd_W_10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>dev_qd_P_10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>FD_cell_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialization of the Gauss quadrature points and quadrature weights to be used for integration over the FD cell faces. A ten points Gauss quadrature formula is used. The obtained quadrature weights and points are copied to the device. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev_qd_W_10</em>&nbsp;</td><td>float array (10 floats) containing the 10 Gauss quadrature weights (on device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dev_qd_P_10</em>&nbsp;</td><td>float array (30 floats) containing the 10 Gauss quadrature points for X, Y and Z contiguously (on device) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FD_cell_size</em>&nbsp;</td><td>3 floats: the dimensions of the used FD cell, (X, Y, Z) respectively </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Jul 6 16:19:19 2010 for GPU_simulations by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
