# Standard problem 4
# @see: http://www.ctcms.nist.gov/~rdm/mumag.org.html
# field 1: µ0Hx=-24.6 mT, µ0Hy= 4.3 mT, µ0Hz= 0.0 mT
# 
#
#  m0 cellsizeX cellsizeY cellsizeZ  msat aexch alpha dt steps savem hx hy hz

N0=128
N1=32
N2=1
X=3.90625e-9
Z=3e-9

all:	m_init.t
	cppsim m_init.t $(X) $(X) $(Z) 800E3 1.3e-11 0.02 0.1E-12 10000 10 -24.6E-3 4.3E-3 0
	make plot

plot:	plot.pdf

plot.pdf:
	bash -c '(for i in m00*.t; do tensor --component Y --average 0 --average 0 --get 0 < $$i; done) > my.txt'
	autoplot.sh plot

m_init.t: 
	tensor --new 3 $(N0) $(N1) $(N2) --setall 1.0 --normalize 0 > m0.t
	cppsim m0.t $(X) $(X) $(Z) 800E3 1.3e-11 1.0 2E-12 2001 2000 0 0 0
	mv m0002000.t m_init.t


.PHONY:	clean
clean:
	rm -f m00*.t kernel.t *.png m0.t m_init.t plot.pdf plot.svg plot.eps my.txt

